#!/usr/bin/env sh

# Load nvm
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

# Use the node version from .nvmrc if it exists
[ -f .nvmrc ] && nvm use

echo "Running pre-commit checks..."

# 1. Check DB version
echo "1/2 Checking DB version..."
./scripts/check-and-update-db-version.sh || exit 1

# 2. Run unit tests (use npm run instead of pnpm directly)
echo "2/2 Running unit tests..."
npm run test:unit || exit 1

echo "âœ“ Pre-commit checks passed!"
exit 0




